"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.TeamsAppAadManager = void 0;
const constants_1 = require("../constants");
class TeamsAppAadManager {
    constructor(lazyAadService, telemetryReporter, logger) {
        this.logger = logger;
        this.telemetryReporter = telemetryReporter;
        this.lazyAadService = lazyAadService;
    }
    async postProvision(aadConfig, apimConfig) {
        const aadService = await this.lazyAadService.getValue();
        const apimClientAADClientId = apimConfig.checkAndGet(constants_1.ApimPluginConfigKeys.apimClientAADClientId);
        const data = { api: { knownClientApplications: [apimClientAADClientId] } };
        await aadService.createServicePrincipalIfNotExists(aadConfig.clientId);
        await aadService.updateAad(aadConfig.objectId, data);
    }
}
exports.TeamsAppAadManager = TeamsAppAadManager;
//# sourceMappingURL=teamsAppAadManager.js.map