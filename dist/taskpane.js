!function(){"use strict";var e={51081:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.JsonConfigUtils=void 0;var n=function(){function e(){this.columns=[]}return e.prototype.getValue=function(){return this.json},e.prototype.addColumn=function(e){return this.columns.push(e),e},e.prototype.addColumnByName=function(e,t,n,o,r,i,a,s,c,l){void 0===c&&(c=!0),void 0===l&&(l=!1);var u={columnName:e,isMandatory:t,horizontalAlignment:n,verticalAlignment:o,columnWidth:r,indentLevel:i,style:a,numberFormat:s,visible:c,autosizeColumn:l};return this.columns.push(u),u},e.prototype.convertColumnDefinitionsToJson=function(){return JSON.stringify(this.columns)},e.prototype.convertToHorizontalAlignment=function(e){switch(e){case"Center":return Excel.HorizontalAlignment.center;case"Left":return Excel.HorizontalAlignment.left;case"Right":return Excel.HorizontalAlignment.right;case"Justify":return Excel.HorizontalAlignment.justify;default:return Excel.HorizontalAlignment.general}},e.prototype.convertToVerticalAlignment=function(e){switch(e){case"Bottom":return Excel.VerticalAlignment.bottom;case"Center":return Excel.VerticalAlignment.center;case"Distributed":return Excel.VerticalAlignment.distributed;case"Justify":return Excel.VerticalAlignment.justify;default:return Excel.VerticalAlignment.top}},e}();t.JsonConfigUtils=n},13409:function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.myConsole=void 0;var n=function(){function e(){e.count=0}return e.addCounter=function(){e.count++},e.log=function(t){console.log(t),e.addCounter(),e.addRow(e.count.toString(),t)},e.addRow=function(e,t){var n=document.querySelector("#myConsole"),o=document.createElement("div");o.classList.add("row");var r=document.createElement("div");r.classList.add("col-2"),r.innerHTML="<small> ".concat(e,"</small>");var i=document.createElement("div");i.classList.add("col-10"),i.innerHTML="<small>".concat(t,"</small>"),o.appendChild(r),o.appendChild(i),n.appendChild(o)},e.reset=function(){e.count=0,document.querySelector("#myConsole").innerHTML=""},e.count=0,e}();t.myConsole=n},88555:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(r,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function s(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((o=o.apply(e,t||[])).next())}))},r=this&&this.__generator||function(e,t){var n,o,r,i,a={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(s){return function(c){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,s[0]&&(a=0)),a;)try{if(n=1,o&&(r=2&s[0]?o.return:s[0]?o.throw||((r=o.return)&&r.call(o),0):o.next)&&!(r=r.call(o,s[1])).done)return r;switch(o=0,r&&(s=[2&s[0],r.value]),s[0]){case 0:case 1:r=s;break;case 4:return a.label++,{value:s[1],done:!1};case 5:a.label++,o=s[1],s=[0];continue;case 7:s=a.ops.pop(),a.trys.pop();continue;default:if(!((r=(r=a.trys).length>0&&r[r.length-1])||6!==s[0]&&2!==s[0])){a=0;continue}if(3===s[0]&&(!r||s[1]>r[0]&&s[1]<r[3])){a.label=s[1];break}if(6===s[0]&&a.label<r[1]){a.label=r[1],r=s;break}if(r&&a.label<r[2]){a.label=r[2],a.ops.push(s);break}r[2]&&a.ops.pop(),a.trys.pop();continue}s=t.call(e,a)}catch(e){s=[6,e],o=0}finally{n=r=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,c])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.run=t.testConfig=t.testJsonFile=t.createConfig=void 0;var i,a,s,c,l,u=n(51081),d=n(13409),m=-1;function f(){return o(this,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return m<=0?(c.load(["rowCount"]),[4,i.sync()]):[3,2];case 1:e.sent(),m=c.rowCount,e.label=2;case 2:return[2,m]}}))}))}var g,h="TableStyleLight10",v="TableStyleLight13";function y(){return o(this,void 0,void 0,(function(){return r(this,(function(e){return[2,document.getElementById("isOrganizer").checked]}))}))}function p(e){return o(this,void 0,void 0,(function(){var t;return r(this,(function(n){return t=document.getElementById("spinner"),e?t.classList.remove("invisible"):t.classList.add("invisible"),[2]}))}))}function b(e){document.getElementById("statusMessage").textContent=e}function C(e,t,n,i,a){return o(this,void 0,void 0,(function(){var o,s,c,l,u,d,m;return r(this,(function(r){switch(o=document.getElementById("analysisInfo"),s=document.createElement("a"),a){case g.Warning:s.classList.add("list-group-item","list-group-item-action","list-group-item-warning");break;case g.Action:s.classList.add("list-group-item","list-group-item-action");break;case g.Danger:s.classList.add("list-group-item","list-group-item-action","list-group-item-danger");break;case g.Success:s.classList.add("list-group-item","list-group-item-action","list-group-item-success")}return(c=document.createElement("div")).classList.add("d-flex","w-100","justify-content-between"),(l=document.createElement("h5")).classList.add("mb-1"),l.innerText=e,(u=document.createElement("span")).classList.add("badge","badge-primary","badge-pill"),0==t&&u.classList.add("invisible"),u.innerText=t.toString(),c.appendChild(l),c.appendChild(u),(d=document.createElement("p")).classList.add("mb-1"),d.innerText=n,(m=document.createElement("small")).innerText=i,s.appendChild(c),s.appendChild(d),s.appendChild(m),o.appendChild(s),[2]}))}))}function w(){return o(this,void 0,void 0,(function(){return r(this,(function(e){return document.getElementById("analysisInfo").innerHTML="",[2]}))}))}function x(e){return o(this,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return a.columns.getItem(e),s.freezePanes.freezeRows(1),s.freezePanes.freezeColumns(3),[4,i.sync()];case 1:return t.sent(),[2]}}))}))}function E(e,t){return void 0===t&&(t=!1),o(this,void 0,void 0,(function(){var n,o,i,a,c;return r(this,(function(r){switch(r.label){case 0:return r.trys.push([0,7,,8]),(n=s.getUsedRange()).load("address"),o=s.tables.getItemOrNullObject("CDL"),i=o.getRange(),[4,e.sync().catch((function(e){C("error",0,e,"create table",g.Danger),console.log(e)}))];case 1:return r.sent(),o.isNullObject?((o=s.tables.add(n,!0)).name="CDL",i=o.getRange(),[4,e.sync()]):[3,3];case 2:r.sent(),r.label=3;case 3:return t?[2]:(i.clear("Formats"),[4,e.sync()]);case 4:return r.sent(),[4,y()];case 5:return a=r.sent(),o.style=a?h:v,o.load("tableStyle"),o.columns.load(),i=o.getRange(),[4,e.sync()];case 6:return r.sent(),[3,8];case 7:return c=r.sent(),C("create Table",0,"Error creating table ".concat(c),"Create Table",g.Danger),console.error(c),b(c),[3,8];case 8:return[2]}}))}))}function A(e){return o(this,void 0,void 0,(function(){var t;return r(this,(function(n){switch(n.label){case 0:return a.columns.load(),[4,i.sync()];case 1:return n.sent(),t=a.columns.getItemOrNullObject("Ignorable").filter,[4,i.sync()];case 2:return n.sent(),t.apply({filterOn:Excel.FilterOn.values,values:[e]}),[4,i.sync()];case 3:return n.sent(),console.log("Cells filtered. "),[2]}}))}))}function O(){return o(this,void 0,void 0,(function(){var e,t;return r(this,(function(n){switch(n.label){case 0:return e=a.columns.getItemOrNullObject("Ignorable").getDataBodyRange(),(t=e.conditionalFormats.add(Excel.ConditionalFormatType.containsText)).textComparison.format.font.color="blue",t.textComparison.format.fill.color="#ADD8E6",t.textComparison.rule={operator:Excel.ConditionalTextOperator.contains,text:"TRUE"},[4,i.sync()];case 1:return n.sent(),[4,D(t.getRange())];case 2:return[2,n.sent()]}}))}))}function L(e){return o(this,void 0,void 0,(function(){var t,n,o,s;return r(this,(function(r){switch(r.label){case 0:return t=a.columns.getItemOrNullObject("ApptSequence"),n=t.getDataBodyRange(),[4,i.sync()];case 1:return r.sent(),o=n.conditionalFormats.add(Excel.ConditionalFormatType.colorScale),s={minimum:{formula:null,type:Excel.ConditionalFormatColorCriterionType.lowestValue,color:"white"},maximum:{formula:null,type:Excel.ConditionalFormatColorCriterionType.highestValue,color:"green"}},o.colorScale.criteria=s,[4,e.sync()];case 2:return r.sent(),[2]}}))}))}function N(e){return o(this,void 0,void 0,(function(){var t,n;return r(this,(function(o){switch(o.label){case 0:return t=a.columns.getItemOrNullObject("Client").getRange(),(n=t.conditionalFormats.add(Excel.ConditionalFormatType.containsText)).textComparison.format.font.color="red",n.textComparison.rule={operator:Excel.ConditionalTextOperator.contains,text:"CRA:CalendarRepairAssistant"},[4,e.sync()];case 1:return o.sent(),[4,D(n.getRange())];case 2:return[2,o.sent()]}}))}))}function S(e){return o(this,void 0,void 0,(function(){var t,n;return r(this,(function(o){switch(o.label){case 0:return t=a.columns.getItemOrNullObject("Trigger").getRange(),(n=t.conditionalFormats.add(Excel.ConditionalFormatType.containsText)).textComparison.format.fill.color="Green",n.textComparison.rule={operator:Excel.ConditionalTextOperator.contains,text:"Create"},[4,e.sync()];case 1:return o.sent(),[4,D(n.getRange())];case 2:return[2,o.sent()]}}))}))}function D(e){return o(this,void 0,void 0,(function(){var t;return r(this,(function(n){switch(n.label){case 0:return[4,i.sync()];case 1:return n.sent(),[4,e.getIntersectionOrNullObject(a.getRange())];case 2:return(t=n.sent()).load(["rowCount"]),[4,i.sync()];case 3:return n.sent(),[2,t?t.rowCount:0]}}))}))}function I(e,t){return void 0===t&&(t=!1),o(this,void 0,void 0,(function(){var n,o,s,c,u,d,m;return r(this,(function(r){switch(r.label){case 0:if("string"==typeof e){if(!function(e){try{var t=JSON.parse(e);return"object"==typeof t&&null!==t}catch(e){return!1}}(e))throw new Error("Invalid JSON string");n=JSON.parse(e)}else{if("object"!=typeof e)throw new Error("Parameter must be a string or an object");n=e}if(!Array.isArray(n))throw new Error("Input JSON is not an array.");r.label=1;case 1:r.trys.push([1,7,,8]),o=0,s=n,r.label=2;case 2:return o<s.length?null==(c=s[o]).columnName||""==c.columnName?(console.log("Skipping json element as it is undefined ColumnName"),[3,5]):((u=a.columns.getItemOrNullObject(c.columnName)).load(["isNullObject"]),(d=u.getDataBodyRange()).load(["format"]),d.format.load(["horizontalAlignment","verticalAlignment"]),i.trackedObjects.add([u,d]),[4,i.sync()]):[3,6];case 3:return r.sent(),u.isNullObject?void 0!==c.isMandatory&&""!==c.isMandatory&&"false"==c.isMandatory?(console.log("isMandatory: ".concat(c.isMandatory)),[3,5]):(console.log("Column Name does not exist: ".concat(c.columnName)),C("columnName",0,"Column Name does not exist: ".concat(c.columnName),"ValidateJSONStruct",g.Danger),[2,!1]):(console.log("Column Name: ".concat(c.columnName)),void 0!==c.style&&""!==c.style&&(console.log("Style: ".concat(c.style)),d.style=c.style),void 0!==c.horizontalAlignment&&""!==c.horizontalAlignment&&(console.log("Horizontal Alignment: ".concat(c.horizontalAlignment)),d.format.horizontalAlignment=l.convertToHorizontalAlignment(c.horizontalAlignment)),void 0!==c.verticalAlignment&&""!==c.verticalAlignment&&(console.log("Vertical Alignment: ".concat(c.verticalAlignment)),d.format.verticalAlignment=l.convertToVerticalAlignment(c.verticalAlignment)),void 0!==c.columnWidth&&null!==c.columnWidth&&(console.log("Column Width: ".concat(c.columnWidth)),d.format.columnWidth=c.columnWidth),void 0!==c.indentLevel&&null!==c.indentLevel&&(console.log("Indent Level: ".concat(c.indentLevel)),d.format.indentLevel=c.indentLevel),void 0!==c.numberFormat&&""!==c.numberFormat&&(console.log("Style: ".concat(c.numberFormat)),d.numberFormat=c.numberFormat),void 0!==c.visible&&null!==c.visible&&(console.log("Visible: ".concat(c.visible)),!c.visible&&t&&(d.columnHidden=!0)),void 0!==c.autosizeColumn&&null!==c.autosizeColumn&&(console.log("autosizeColumn: ".concat(c.autosizeColumn)),"true"===c.autosizeColumn&&d.format.autofitColumns()),[4,i.sync()]);case 4:r.sent(),console.log("removing tracked objects for ".concat(c.columnName)),i.trackedObjects.remove([u,d]),r.label=5;case 5:return o++,[3,2];case 6:return[2,!0];case 7:return m=r.sent(),C("columnName",0,"Error traversing JSON array: ".concat(m),"ValidateJSONStruct",g.Danger),console.error("Error traversing JSON array: ".concat(m)),[2,!1];case 8:return[2]}}))}))}function T(){return o(this,void 0,void 0,(function(){var e,t,n,o,s,c,l,d,m,f,g,h,v,y,p,b;return r(this,(function(r){switch(r.label){case 0:return e=new u.JsonConfigUtils,t=a.columns.load(["name","values/format","values/horizontalAlignment","values/verticalAlignment","values/columnWidth","values/indentLevel","values/style","values/numberFormat","values/autosizeColumn"]),[4,i.sync()];case 1:r.sent(),n=0,o=t.items,r.label=2;case 2:return n<o.length?(s=o[n],(c=s.getRange().getCell(0,0)).load(["columnHidden"]),[4,i.sync()]):[3,6];case 3:return r.sent(),c.columnHidden,(l=s.getDataBodyRange()).load(["style","numberFormat","columnHidden"]),l.format.load(["format","horizontalAlignment","verticalAlignment","columnWidth","indentLevel","style","numberFormat"]),[4,i.sync()];case 4:r.sent(),d=s.name,l.format,m=l.format.horizontalAlignment,f=l.format.verticalAlignment,g=l.format.columnWidth,h=l.format.indentLevel,v=l.style,y=l.numberFormat[0].toString(),p=!c.columnHidden,b={columnName:d,isMandatory:!0,horizontalAlignment:m,verticalAlignment:f,columnWidth:g,indentLevel:h,style:v,numberFormat:y,visible:p,autosizeColumn:!1},e.addColumn(b),r.label=5;case 5:return n++,[3,2];case 6:return[2,e]}}))}))}function j(){return o(this,void 0,void 0,(function(){var e;return r(this,(function(t){switch(t.label){case 0:return[4,document.getElementById("typeCDL").value];case 1:switch(t.sent()){case"rave-diag-log":return[3,2];case"exo-cdl":return[3,4]}return[3,6];case 2:case 6:return[4,fetch("./RaveCDLconfig.json")];case 3:case 5:case 7:return e=t.sent(),[3,8];case 4:return[4,fetch("./EXOCDLconfig.json")];case 8:return[4,e.json()];case 9:return[2,t.sent()]}}))}))}function R(e){return o(this,void 0,void 0,(function(){return r(this,(function(t){switch(t.label){case 0:return[4,w()];case 1:return t.sent(),[4,z()];case 2:return t.sent(),[4,e.sync()];case 3:return t.sent(),[2]}}))}))}function z(){return o(this,void 0,void 0,(function(){var e;return r(this,(function(t){switch(t.label){case 0:return z?[4,f()]:[2];case 1:return(e=t.sent())>=950&&(C("Row count number",e,"Number of rows is very close(or above) the Diag Limit of 1000Rows","CheckNumberOfRows",g.Warning),b("Number of rows is very close to the Diag Limit of 1000Rows returned($tblRange.rowCount)")),[4,i.sync()];case 2:return t.sent(),[2]}}))}))}function F(){return o(this,void 0,void 0,(function(){var e=this;return r(this,(function(t){switch(t.label){case 0:return d.myConsole.reset(),[4,Excel.run((function(t){return o(e,void 0,void 0,(function(){var e;return r(this,(function(n){switch(n.label){case 0:return i=t,s=t.workbook.worksheets.getActiveWorksheet(),a=s.tables.getItemOrNullObject("CDL"),c=a.getRange(),l=new u.JsonConfigUtils,[4,t.sync()];case 1:return n.sent(),[4,E(t,!0)];case 2:return n.sent(),[4,T()];case 3:return e=n.sent(),document.getElementById("jsonConfig").textContent=e.convertColumnDefinitionsToJson(),[2]}}))}))}))];case 1:return t.sent(),[2]}}))}))}function k(){return o(this,void 0,void 0,(function(){var e;return r(this,(function(t){switch(t.label){case 0:return d.myConsole.reset(),[4,j()];case 1:return e=t.sent(),document.getElementById("jsonConfig").textContent=JSON.stringify(e),[4,I(e)];case 2:return t.sent(),[2]}}))}))}function J(){return o(this,void 0,void 0,(function(){return r(this,(function(e){switch(e.label){case 0:return d.myConsole.reset(),[4,I(document.getElementById("jsonConfig").value)];case 1:return e.sent(),[2]}}))}))}function H(){return o(this,void 0,void 0,(function(){var e,t=this;return r(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,Excel.run((function(e){return o(t,void 0,void 0,(function(){var t;return r(this,(function(n){switch(n.label){case 0:return d.myConsole.reset(),[4,p(!0)];case 1:return n.sent(),[4,w()];case 2:return n.sent(),[4,b("Starting Processing")];case 3:for(n.sent(),t=0;t<50;t++)d.myConsole.log("mensagem de teste");return i=e,s=e.workbook.worksheets.getActiveWorksheet(),a=s.tables.getItemOrNullObject("CDL"),c=a.getRange(),l=new u.JsonConfigUtils,s.getRange().clear("Formats"),s.getRange().conditionalFormats.clearAll(),a.clearFilters(),s.freezePanes.unfreeze(),[4,e.sync()];case 4:return n.sent(),[4,E(e).then((function(){b("Create Table Done")}))];case 5:return n.sent(),[4,j()];case 6:return[4,I(n.sent())];case 7:return n.sent()?[4,x("Ignorable")]:(C("CDL Invalid",0,"CDL Structure is invalid (check previous exceptions)","CDLInvalid",g.Danger),p(!1),[2]);case 8:return n.sent(),[4,O().then((function(){b("Highlight Ignorable Done")}))];case 9:return n.sent(),[4,L(e).then((function(){b("Highlight  Done")}))];case 10:return n.sent(),[4,N(e).then((function(){b("Highlight CRA Done")}))];case 11:return n.sent(),[4,S(e).then((function(){b("Highlight Create Done")}))];case 12:return n.sent(),[4,A("FALSE").then((function(){b("Filter Ignorable Done")}))];case 13:return n.sent(),[4,e.sync()];case 14:return n.sent(),[4,R(e).then((function(){b("Perform Analysis Done")}))];case 15:return n.sent(),console.log("Processing done."),b("Done!"),p(!1),C("Success",0,"Process executed successfully, check the video on CDL analysis ".concat("https://msit.microsoftstream.com/video/4221a4ff-0400-9fb2-4805-f1eb0f28f09b"," "),"success",g.Success),[2]}}))}))}))];case 1:return n.sent(),[3,3];case 2:return e=n.sent(),p(!1),console.error(e),b(e),C("Error",0,e,"Run/Catch",g.Danger),[3,3];case 3:return[2]}}))}))}!function(e){e[e.Warning=0]="Warning",e[e.Action=1]="Action",e[e.Danger=2]="Danger",e[e.Success=3]="Success"}(g||(g={})),Office.onReady((function(e){e.host===Office.HostType.Excel&&(l=new u.JsonConfigUtils,document.getElementById("sideload-msg").style.display="none",document.getElementById("run").onclick=H,document.getElementById("createConfig").onclick=F,document.getElementById("testConfig").onclick=J,document.getElementById("testJsonFile").onclick=k,$((function(){$('[data-toggle="tooltip"]').tooltip()})),w())})),t.createConfig=F,t.testJsonFile=k,t.testConfig=J,t.run=H},93823:function(e,t,n){var o=n(27091),r=n.n(o),i=new URL(n(60806),n.b);r()(i)},27091:function(e){e.exports=function(e,t){return t||(t={}),e?(e=String(e.__esModule?e.default:e),t.hash&&(e+=t.hash),t.maybeNeedQuotes&&/[\t\n\f\r "'=<>`]/.test(e)?'"'.concat(e,'"'):e):e}},60806:function(e,t,n){e.exports=n.p+"4f424550f2dc5a27a461.css"}},t={};function n(o){var r=t[o];if(void 0!==r)return r.exports;var i=t[o]={exports:{}};return e[o].call(i.exports,i,i.exports,n),i.exports}n.m=e,n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},function(){var e;n.g.importScripts&&(e=n.g.location+"");var t=n.g.document;if(!e&&t&&(t.currentScript&&(e=t.currentScript.src),!e)){var o=t.getElementsByTagName("script");o.length&&(e=o[o.length-1].src)}if(!e)throw new Error("Automatic publicPath is not supported in this browser");e=e.replace(/#.*$/,"").replace(/\?.*$/,"").replace(/\/[^\/]+$/,"/"),n.p=e}(),n.b=document.baseURI||self.location.href,n(88555),n(93823)}();
//# sourceMappingURL=taskpane.js.map